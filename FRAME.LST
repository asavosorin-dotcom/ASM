Turbo Assembler	 Version 4.1	    02/11/26 08:35:29	    Page 1
frame.asm



      1	0000			     .model tiny
      2	0000			     .code
      3
      4				     org 100h
      5
      6				     DRAW macro	length,	pos_x, pos_y
      7					     mov bx, length
      8					     mov cx, pos_x
      9					     mov di, pos_y
     10					     call draw_string
     11				     ENDM
     12
     13				     DRAW_COL macro height, pos_x, pos_y
     14					     mov bx, height
     15					     mov cx, pos_x
     16					     mov di, pos_y
     17					     call draw_column
     18				     ENDM
     19
     20				     MUL_R macro mlp1, mlp2
     21					     push ax
     22					     mov ax, mlp1
     23					     mul mlp2
     24					     mov mlp1, ax
     25					     pop ax
     26				     ENDM
     27	0100			     Start:
     28					     ;переход в	сегмент	видеопамяти
     29	0100  B8 B800			     mov ax, 0B800h
     30	0103  8E C0			     mov es, ax
     31
     32					     DRAW     30, 10, 0
1    33	0105  BB 001E			     mov bx, 30
1    34	0108  B9 000A			     mov cx, 10
1    35	010B  BF 0000			     mov di, 0
1    36	010E  E8 001C			     call draw_string
     37					     DRAW_COL 5,  11, 0
1    38	0111  BB 0005			     mov bx, 5
1    39	0114  B9 000B			     mov cx, 11
1    40	0117  BF 0000			     mov di, 0
1    41	011A  E8 0037			     call draw_column
     42
     43					     ;DRAW     30, 10, 10
     44					     DRAW_COL 5,  40, 0
1    45	011D  BB 0005			     mov bx, 5
1    46	0120  B9 0028			     mov cx, 40
1    47	0123  BF 0000			     mov di, 0
1    48	0126  E8 002B			     call draw_column
     49
     50	0129  B4 4C			     mov ah, 4ch
     51	012B  CD 21			     int 21h
     52
     53	012D				     draw_string proc
     54
     55						     ;mov word ptr es: [bx+160*4l + 80], (4e03h	or 8000h)
     56						     ;mov bx, 80 ;счетчик
     57
Turbo Assembler	 Version 4.1	    02/11/26 08:35:29	    Page 2
frame.asm



     58						     ;cx pos_x
     59						     ;di pos_y
     60
     61	012D  D1 E1				     shl cx, 1	     ; умножение на 2 (2 байта на символ)
     62	012F  D1 E3				     shl bx, 1	     ; умножение на 2 (2 байта на символ)
     63
     64					     ;=====умножение смещения y	на 160=======
     65	0131  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
     66	      E7 D1 E7
     67	013B  53				     push bx
     68	013C  8B DF				     mov bx, di
     69	013E  D1 E7 D1 E7			     shl di, 2
     70	0142  03 FB				     add di, bx
     71	0144  5B				     pop bx
     72					     ;=================================
     73	0145  03 F9				     add di, cx
     74						     ;add bx, cx
     75						     ; переписать вывод	строки!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
     76	0147					     string:
     77	0147  26: C7 01	CE03				     mov word ptr es:[bx + di],	(4e03h or 8000h)
     78	014C  4B					     dec bx
     79	014D  4B					     dec bx
     80	014E  83 FB 00					     cmp bx, 0
     81	0151  7F F4					     jg	string
     82
     83	0153  C3				     ret;
     84	0154				     draw_string endp
     85
     86	0154				     draw_column proc
     87						     ;cx pos_x
     88						     ;di pos_y
     89						     ;dec bx
     90	0154  D1 E1				     shl cx, 1	     ; умножение на 2 (2 байта на символ)
     91	0156  D1 E3				     shl bx, 1	     ; умножение на 2 (2 байта на символ)
     92
     93						     ;=====умножение смещения на 160=======
     94	0158  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
     95	      E7 D1 E7
     96	0162  53				     push bx
     97	0163  8B DF				     mov bx, di
     98	0165  D1 E7 D1 E7			     shl di, 2
     99	0169  03 FB				     add di, bx
    100	016B  5B				     pop bx
    101						     ;=====================================
    102
    103	016C  50				     push ax
    104	016D  51				     push cx
    105	016E  8B C3				     mov ax, bx
    106	0170  B9 0050				     mov cx, 80
    107	0173  F7 E1				     mul cx
    108	0175  8B D8				     mov bx, ax
    109	0177  59				     pop cx
    110	0178  58				     pop ax
    111
    112	0179  03 F9				     add di, cx
    113	017B					     print_column:
    114	017B  26: C7 01	CE03				     mov word ptr es:[bx + di],	(4e03h or 8000h)
Turbo Assembler	 Version 4.1	    02/11/26 08:35:29	    Page 3
frame.asm



    115	0180  81 EB 00A0				     sub bx, 160
    116							     ;dec bx
    117	0184  83 FB 00					     cmp bx, 0
    118	0187  7F F2					     jg	print_column
    119	0189  C3					     ret;
    120
    121	018A				     draw_column endp
    122
    123				     end     Start
Turbo Assembler	 Version 4.1	    02/11/26 08:35:29	    Page 4
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/11/26"
??FILENAME			  Text	 "frame	  "
??TIME				  Text	 "08:35:29"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 FRAME
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
DRAW_COLUMN			  Near	 DGROUP:0154
DRAW_STRING			  Near	 DGROUP:012D
PRINT_COLUMN			  Near	 DGROUP:017B
START				  Near	 DGROUP:0100
STRING				  Near	 DGROUP:0147

Macro Name

DRAW
DRAW_COL
MUL_R

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  018A Word	  Public  CODE
