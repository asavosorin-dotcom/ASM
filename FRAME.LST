Turbo Assembler	 Version 4.1	    02/14/26 20:11:23	    Page 1
frame.asm



      1	0000			     .model tiny
      2	0000			     .code
      3
      4				     org 100h
      5
      6				     ;===========================================================================
      7				     ;DESTR: ax, bx, cx, di
      8				     ;===========================================================================
      9
     10				     DRAW_COL macro height, pos_x, pos_y, symbol
     11					     mov bx, height
     12					     mov cx, pos_x
     13					     mov di, pos_y
     14
     15					     mov ax, symbol
     16					     push ax
     17
     18					     call draw_column
     19				     ENDM
     20
     21				     ;===========================================================================
     22				     ;DESTR: ax, bx, cx, di
     23				     ;===========================================================================
     24
     25				     DRAW_STR macro length, pos_x, pos_y, symbol
     26					     mov bx, length
     27					     mov cx, pos_x
     28					     mov di, pos_y
     29
     30					     mov ax, symbol
     31					     push ax
     32
     33					     call draw_string
     34				     ENDM
     35
     36				     DRAW_FRAME	macro length, height, pos_x, pos_y, symbol
     37
     38					     DRAW_STR length, pos_x, pos_y, symbol
     39					     DRAW_COL height, pos_x, pos_y, symbol
     40
     41					     Sum_y = pos_y + height - 1
     42					     Sum_x = pos_x + length - 1
     43
     44					     DRAW_STR length, pos_x, Sum_y, symbol
     45					     DRAW_COL height, Sum_x, pos_y, symbol
     46
     47				     ENDM
     48
     49				     DRAW_FRAME_WORD macro length, height, pos_x, pos_y, symbol
     50
     51					     DRAW_FRAME	length,	height,	pos_x, pos_y, symbol
     52					     BEG = (Sum_y + pos_y) / 2 * 160 + pos_x * 2 + length
     53
     54				     ENDM
     55
     56				     ;очистка экрана
     57				     ;INT 10H 006H
Turbo Assembler	 Version 4.1	    02/14/26 20:11:23	    Page 2
frame.asm



     58
     59	0100			     Start:
     60					     ;
     61	0100  B8 B800			     mov ax, 0B800h
     62	0103  8E C0			     mov es, ax
     63
     64					     ; Подумать	как можно передавать символ для	всех рамок
     65					     ; lea bx, Symbol_arr
     66					     ; add bx, 2
     67
     68					     ; push bx
     69
     70					     DRAW_FRAME_WORD 30, 5, 10,	3, [Symbol_arr]
1    71
1    72					     DRAW_FRAME	30, 5, 10, 3, [Symbol_arr]
2    73
2    74					     DRAW_STR 30, 10, 3, [Symbol_arr]
3    75	0105  BB 001E			     mov bx, 30
3    76	0108  B9 000A			     mov cx, 10
3    77	010B  BF 0003			     mov di, 3
3    78
3    79	010E  A1 014Cr			     mov ax, [Symbol_arr]
3    80	0111  50			     push ax
3    81
3    82	0112  E8 003B			     call draw_string
2    83					     DRAW_COL 5, 10, 3,	[Symbol_arr]
3    84	0115  BB 0005			     mov bx, 5
3    85	0118  B9 000A			     mov cx, 10
3    86	011B  BF 0003			     mov di, 3
3    87
3    88	011E  A1 014Cr			     mov ax, [Symbol_arr]
3    89	0121  50			     push ax
3    90
3    91	0122  E8 0061			     call draw_column
2    92
2    93	      =0007			     Sum_y = 3 + 5 - 1
2    94	      =0027			     Sum_x = 10	+ 30 - 1
2    95
2    96					     DRAW_STR 30, 10, Sum_y, [Symbol_arr]
3    97	0125  BB 001E			     mov bx, 30
3    98	0128  B9 000A			     mov cx, 10
3    99	012B  BF 0007			     mov di, Sum_y
3   100
3   101	012E  A1 014Cr			     mov ax, [Symbol_arr]
3   102	0131  50			     push ax
3   103
3   104	0132  E8 001B			     call draw_string
2   105					     DRAW_COL 5, Sum_x,	3, [Symbol_arr]
3   106	0135  BB 0005			     mov bx, 5
3   107	0138  B9 0027			     mov cx, Sum_x
3   108	013B  BF 0003			     mov di, 3
3   109
3   110	013E  A1 014Cr			     mov ax, [Symbol_arr]
3   111	0141  50			     push ax
3   112
3   113	0142  E8 0041			     call draw_column
2   114
Turbo Assembler	 Version 4.1	    02/14/26 20:11:23	    Page 3
frame.asm



1   115	      =0352			     BEG = (Sum_y + 3) / 2 * 160 + 10 *	2 + 30
1   116
    117
    118					     ;pop bx
    119				     ;	     DRAW_STR 10, 5, 3,	1F03h
    120				     ;	     DRAW_COL 6,  10, 0, 1F03h
    121				     ;
    122				     ;	     DRAW_STR 29, 10, 5
    123				     ;	     DRAW_COL 6,  40, 0
    124
    125	0145  E8 0081			     call print_word_in_frame
    126
    127					     ;DRAW_FRAME 8, 3, 1, 1, 1F03h or 8080h
    128
    129	0148  B4 4C			     mov ah, 4ch
    130	014A  CD 21			     int 21h
    131
    132	014C  1F03 4E03			     Symbol_arr	dw 1F03h, 4E03h
    133
    134	0150				     draw_string proc
    135	0150  55				     push bp
    136	0151  8B EC				     mov bp, sp
    137	0153  83 C5 04				     add bp, 4
    138						     ;mov word ptr es: [bx+160*4l + 80], (4e03h	or 8000h)
    139						     ;mov bx, 80 ;
    140
    141						     ;cx pos_x
    142						     ;di pos_y
    143	0156  4B				     dec bx
    144	0157  D1 E1				     shl cx, 1	     ;
    145	0159  D1 E3				     shl bx, 1	     ;
    146
    147					     ;===== Умножение смещения на 160=======
    148	015B  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
    149	      E7 D1 E7
    150	0165  53				     push bx
    151	0166  8B DF				     mov bx, di
    152	0168  D1 E7 D1 E7			     shl di, 2
    153	016C  03 FB				     add di, bx
    154	016E  5B				     pop bx
    155					     ;=================================
    156	016F  03 F9				     add di, cx
    157						     ;add bx, cx
    158
    159	0171  51				     push cx
    160	0172  33 C9				     xor cx, cx
    161	0174  8B 4E 00				     mov word ptr cx, [bp]
    162
    163	0177					     string:
    164	0177  26: 89 09					     mov word ptr es:[bx + di],	cx
    165	017A  4B					     dec bx
    166	017B  4B					     dec bx
    167	017C  83 FB 00					     cmp bx, 0
    168	017F  7D F6					     jge string
    169
    170	0181  59				     pop cx
    171
Turbo Assembler	 Version 4.1	    02/14/26 20:11:23	    Page 4
frame.asm



    172	0182  5D				     pop bp
    173
    174	0183  C2 0002				     ret 2
    175
    176	0186				     draw_string endp
    177
    178	0186				     draw_column proc
    179	0186  55				     push bp
    180	0187  8B EC				     mov bp, sp
    181	0189  83 C5 04				     add bp, 4 ; пропускаем адрес возврата
    182
    183						     ;cx pos_x
    184						     ;di pos_y
    185	018C  4B				     dec bx
    186	018D  D1 E1				     shl cx, 1	     ; 2 байта на символ
    187	018F  D1 E3				     shl bx, 1	     ; 2 байта на символ
    188
    189						     ;===== Умножение смещения y на 160=======
    190	0191  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
    191	      E7 D1 E7
    192	019B  53				     push bx
    193	019C  8B DF				     mov bx, di
    194	019E  D1 E7 D1 E7			     shl di, 2
    195	01A2  03 FB				     add di, bx
    196	01A4  5B				     pop bx
    197						     ;=====================================
    198
    199	01A5  50				     push ax
    200	01A6  51				     push cx
    201	01A7  8B C3				     mov ax, bx
    202	01A9  B9 0050				     mov cx, 80
    203	01AC  F7 E1				     mul cx
    204	01AE  8B D8				     mov bx, ax
    205	01B0  59				     pop cx
    206	01B1  58				     pop ax
    207
    208	01B2  03 F9				     add di, cx
    209
    210	01B4  51				     push cx
    211	01B5  8B 4E 00				     mov word ptr cx, [bp]
    212
    213	01B8					     print_column:
    214	01B8  26: 89 09					     mov word ptr es:[bx + di],	cx
    215	01BB  81 EB 00A0				     sub bx, 160
    216							     ;dec bx
    217	01BF  83 FB 00					     cmp bx, 0
    218	01C2  7D F4					     jge print_column
    219
    220	01C4  59				     pop cx
    221	01C5  5D				     pop bp
    222
    223	01C6  C2 0002				     ret 2
    224
    225
    226	01C9				     draw_column endp
    227
    228	01C9				     print_word_in_frame proc
Turbo Assembler	 Version 4.1	    02/14/26 20:11:23	    Page 5
frame.asm



    229	01C9  51					     push cx
    230	01CA  57					     push di
    231	01CB  33 C9					     xor cx, cx
    232	01CD  33 FF					     xor di, di
    233	01CF  8A 0E 0080				     mov cl, ds:80h
    234
    235	01D3  80 F9 00					     cmp cl, 0
    236	01D6  74 1C					     je	??return
    237
    238	01D8  FE C9					     dec cl
    239	01DA  BE 0082					     mov si, 82h
    240							     ;BEG equ 5	* 160 +	40
    241	01DD  8B F9					     mov di, cx
    242	01DF  D1 EF D1 EF				     shr di, 2
    243	01E3  D1 E7					     shl di, 1
    244	01E5  F7 DF					     neg di
    245	01E7  83 EF 02					     sub di, 2
    246	01EA  81 C7 0352				     add di, BEG
    247							     ;mov di, BEG ;  
    248	01EE  B4 9F					     mov ah, (1Fh or 88h) ;
    249	01F0						     L:
    250	01F0  AC						     lodsb
    251	01F1  AB						     stosw
    252	01F2  E2 FC						     loop L
    253
    254	01F4						     ??return:
    255	01F4  5F					     pop di
    256	01F5  59					     pop cx
    257	01F6  C3					     ret
    258	01F7				     endp
    259
    260				     end     Start
Turbo Assembler	 Version 4.1	    02/14/26 20:11:23	    Page 6
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/14/26"
??FILENAME			  Text	 "frame	  "
??RETURN			  Near	 DGROUP:01F4
??TIME				  Text	 "20:11:23"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 FRAME
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BEG				  Number 0352
DRAW_COLUMN			  Near	 DGROUP:0186
DRAW_STRING			  Near	 DGROUP:0150
L				  Near	 DGROUP:01F0
PRINT_COLUMN			  Near	 DGROUP:01B8
PRINT_WORD_IN_FRAME		  Near	 DGROUP:01C9
START				  Near	 DGROUP:0100
STRING				  Near	 DGROUP:0177
SUM_X				  Number 0027
SUM_Y				  Number 0007
SYMBOL_ARR			  Word	 DGROUP:014C

Macro Name

DRAW_COL
DRAW_FRAME
DRAW_FRAME_WORD
DRAW_STR

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  01F7 Word	  Public  CODE
