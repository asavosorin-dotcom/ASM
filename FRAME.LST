Turbo Assembler	 Version 4.1	    02/15/26 11:40:00	    Page 1
frame.asm



      1	0000			     .model tiny
      2	0000			     .code
      3
      4				     org 100h
      5
      6				     local @@
      7
      8				     ;===========================================================================
      9				     ;DESTR: ax, bx, cx, di
     10				     ;===========================================================================
     11
     12				     ; можно передавать	аргументом символа его адрес в памяти
     13
     14				     ; надо написать процедуру,	которая	считывает число	из командной строки
     15
     16				     DRAW_COL macro height, pos_x, pos_y, symbol
     17					     mov bx, height
     18					     mov cx, pos_x
     19					     mov di, pos_y
     20
     21					     ; mov ax, symbol
     22					     ; push ax
     23
     24					     call draw_column
     25				     ENDM
     26
     27				     ;===========================================================================
     28				     ;DESTR: ax, bx, cx, di
     29				     ;===========================================================================
     30
     31				     DRAW_STR macro length, pos_x, pos_y, symbol
     32					     mov  bx, length
     33					     mov  cx, pos_x
     34					     mov  di, pos_y
     35
     36					     ; mov  ax,	symbol
     37					     ; push ax
     38
     39					     call draw_string
     40				     ENDM
     41
     42				     DRAW_FRAME	macro length, height, pos_x, pos_y, symbol
     43
     44					     lea bx, Symbol_arr
     45					     add bx, symbol
     46
     47					     push [bx]
     48
     49					     DRAW_STR length, pos_x, pos_y, symbol
     50					     DRAW_COL height, pos_x, pos_y, symbol
     51
     52					     Sum_y = pos_y + height - 1
     53					     Sum_x = pos_x + length - 1
     54
     55					     DRAW_STR length, pos_x, Sum_y, symbol
     56					     DRAW_COL height, Sum_x, pos_y, symbol
     57
Turbo Assembler	 Version 4.1	    02/15/26 11:40:00	    Page 2
frame.asm



     58					     add sp, 2
     59
     60				     ENDM
     61
     62				     DRAW_FRAME_WORD macro length, height, pos_x, pos_y, symbol
     63
     64					     DRAW_FRAME	length,	height,	pos_x, pos_y, symbol
     65					     BEG = (Sum_y + pos_y) / 2 * 160 + pos_x * 2 + length
     66
     67				     ENDM
     68
     69				     ;очистка экрана
     70				     ;INT 10H 006H
     71
     72	0100			     Start:
     73					     ;
     74	0100  B8 B800			     mov ax, 0B800h
     75	0103  8E C0			     mov es, ax
     76
     77					     ; Подумать	как можно передавать символ для	всех рамок
     78
     79					     DRAW_FRAME_WORD 30, 5, 10,	3, 2
1    80
1    81					     DRAW_FRAME	30, 5, 10, 3, 2
2    82
2    83	0105  BB 0147r			     lea bx, Symbol_arr
2    84	0108  83 C3 02			     add bx, 2
2    85
2    86	010B  FF 37			     push [bx]
2    87
2    88					     DRAW_STR 30, 10, 3, 2
3    89	010D  BB 001E			     mov  bx, 30
3    90	0110  B9 000A			     mov  cx, 10
3    91	0113  BF 0003			     mov  di, 3
3    92
3    93					     ; mov  ax,	2
3    94					     ; push ax
3    95
3    96	0116  E8 0032			     call draw_string
2    97					     DRAW_COL 5, 10, 3,	2
3    98	0119  BB 0005			     mov bx, 5
3    99	011C  B9 000A			     mov cx, 10
3   100	011F  BF 0003			     mov di, 3
3   101
3   102					     ; mov ax, 2
3   103					     ; push ax
3   104
3   105	0122  E8 005A			     call draw_column
2   106
2   107	      =0007			     Sum_y = 3 + 5 - 1
2   108	      =0027			     Sum_x = 10	+ 30 - 1
2   109
2   110					     DRAW_STR 30, 10, Sum_y, 2
3   111	0125  BB 001E			     mov  bx, 30
3   112	0128  B9 000A			     mov  cx, 10
3   113	012B  BF 0007			     mov  di, Sum_y
3   114
Turbo Assembler	 Version 4.1	    02/15/26 11:40:00	    Page 3
frame.asm



3   115					     ; mov  ax,	2
3   116					     ; push ax
3   117
3   118	012E  E8 001A			     call draw_string
2   119					     DRAW_COL 5, Sum_x,	3, 2
3   120	0131  BB 0005			     mov bx, 5
3   121	0134  B9 0027			     mov cx, Sum_x
3   122	0137  BF 0003			     mov di, 3
3   123
3   124					     ; mov ax, 2
3   125					     ; push ax
3   126
3   127	013A  E8 0042			     call draw_column
2   128
2   129	013D  83 C4 02			     add sp, 2
2   130
1   131	      =0352			     BEG = (Sum_y + 3) / 2 * 160 + 10 *	2 + 30
1   132
    133
    134					     ;pop bx
    135				     ;	     DRAW_STR 10, 5, 3,	1F03h
    136				     ;	     DRAW_COL 6,  10, 0, 1F03h
    137				     ;
    138				     ;	     DRAW_STR 29, 10, 5
    139				     ;	     DRAW_COL 6,  40, 0
    140
    141	0140  E8 007D			     call print_word_in_frame
    142
    143					     ;DRAW_FRAME 8, 3, 1, 1, 1F03h or 8080h
    144
    145	0143  B4 4C			     mov ah, 4ch
    146	0145  CD 21			     int 21h
    147
    148	0147  1F03 4E03			     Symbol_arr	dw 1F03h, 4E03h
    149
    150
    151	014B				     draw_string proc
    152	014B  55				     push bp
    153	014C  8B EC				     mov bp, sp
    154	014E  83 C5 04				     add bp, 4
    155						     ;mov word ptr es: [bx+160*4l + 80], (4e03h	or 8000h)
    156						     ;mov bx, 80 ;
    157
    158						     ;cx pos_x
    159						     ;di pos_y
    160	0151  4B				     dec bx
    161	0152  D1 E1				     shl cx, 1	     ;
    162	0154  D1 E3				     shl bx, 1	     ;
    163
    164					     ;===== Умножение смещения на 160=======
    165	0156  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
    166	      E7 D1 E7
    167	0160  53				     push bx
    168	0161  8B DF				     mov bx, di
    169	0163  D1 E7 D1 E7			     shl di, 2
    170	0167  03 FB				     add di, bx
    171	0169  5B				     pop bx
Turbo Assembler	 Version 4.1	    02/15/26 11:40:00	    Page 4
frame.asm



    172					     ;=================================
    173	016A  03 F9				     add di, cx
    174						     ;add bx, cx
    175
    176	016C  51				     push cx
    177	016D  33 C9				     xor cx, cx
    178	016F  8B 4E 00				     mov word ptr cx, [bp]
    179
    180	0172					     string:
    181	0172  26: 89 09					     mov word ptr es:[bx + di],	cx
    182	0175  4B					     dec bx
    183	0176  4B					     dec bx
    184	0177  83 FB 00					     cmp bx, 0
    185	017A  7D F6					     jge string
    186
    187	017C  59				     pop cx
    188
    189	017D  5D				     pop bp
    190
    191	017E  C3				     ret
    192
    193	017F				     draw_string endp
    194
    195	017F				     draw_column proc
    196	017F  55				     push bp
    197	0180  8B EC				     mov bp, sp
    198	0182  83 C5 04				     add bp, 4 ; пропускаем адрес возврата
    199
    200						     ;cx pos_x
    201						     ;di pos_y
    202	0185  4B				     dec bx
    203	0186  D1 E1				     shl cx, 1	     ; 2 байта на символ
    204	0188  D1 E3				     shl bx, 1	     ; 2 байта на символ
    205
    206						     ;===== Умножение смещения y на 160=======
    207	018A  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
    208	      E7 D1 E7
    209	0194  53				     push bx
    210	0195  8B DF				     mov bx, di
    211	0197  D1 E7 D1 E7			     shl di, 2
    212	019B  03 FB				     add di, bx
    213	019D  5B				     pop bx
    214						     ;=====================================
    215
    216	019E  50				     push ax
    217	019F  51				     push cx
    218	01A0  8B C3				     mov ax, bx
    219	01A2  B9 0050				     mov cx, 80
    220	01A5  F7 E1				     mul cx
    221	01A7  8B D8				     mov bx, ax
    222	01A9  59				     pop cx
    223	01AA  58				     pop ax
    224
    225	01AB  03 F9				     add di, cx
    226
    227	01AD  51				     push cx
    228	01AE  8B 4E 00				     mov word ptr cx, [bp]
Turbo Assembler	 Version 4.1	    02/15/26 11:40:00	    Page 5
frame.asm



    229
    230	01B1					     print_column:
    231	01B1  26: 89 09					     mov word ptr es:[bx + di],	cx
    232	01B4  81 EB 00A0				     sub bx, 160
    233							     ;dec bx
    234	01B8  83 FB 00					     cmp bx, 0
    235	01BB  7D F4					     jge print_column
    236
    237	01BD  59				     pop cx
    238	01BE  5D				     pop bp
    239
    240	01BF  C3				     ret
    241
    242
    243	01C0				     draw_column endp
    244				     ;====================================================================
    245				     ;Start:
    246				     ;	 di - counter of symbols
    247				     ;	     si	- adress of string
    248				     ;Return: ax - число
    249				     ;====================================================================
    250	01C0				     print_word_in_frame proc
    251	01C0  51					     push cx
    252	01C1  57					     push di
    253	01C2  33 C9					     xor cx, cx
    254	01C4  33 FF					     xor di, di
    255	01C6  8A 0E 0080				     mov cl, ds:80h
    256
    257	01CA  80 F9 00					     cmp cl, 0
    258	01CD  74 1C					     je	@@return
    259
    260	01CF  FE C9					     dec cl
    261	01D1  BE 0082					     mov si, 82h
    262							     ;BEG equ 5	* 160 +	40
    263	01D4  8B F9					     mov di, cx
    264	01D6  D1 EF D1 EF				     shr di, 2
    265	01DA  D1 E7					     shl di, 1
    266	01DC  F7 DF					     neg di
    267	01DE  83 EF 02					     sub di, 2
    268	01E1  81 C7 0352				     add di, BEG
    269							     ;mov di, BEG ;  
    270	01E5  B4 9F					     mov ah, (1Fh or 88h) ;
    271	01E7						     L:
    272	01E7  AC						     lodsb
    273	01E8  AB						     stosw
    274	01E9  E2 FC						     loop L
    275
    276	01EB						     @@return:
    277	01EB  5F					     pop di
    278	01EC  59					     pop cx
    279	01ED  C3					     ret
    280	01EE				     endp
    281
    282				     ;====================================================================
    283				     ; Start:  di - number of symbols
    284				     ;		       si - adress of string
    285				     ; Destr:  di, si, dx, ax
Turbo Assembler	 Version 4.1	    02/15/26 11:40:00	    Page 6
frame.asm



    286				     ; Return: dx - число
    287				     ;====================================================================
    288	01EE				     get_num_from_command proc
    289	01EE  80 3C 20				     cmp byte ptr[si], ' '
    290	01F1  74 F8				     je	@@return
    291	01F3  33 C0				     xor ax, ax
    292	01F5  33 D2				     xor dx, dx
    293
    294	01F7					      @@digit:
    295	01F7  AC					     lodsb
    296
    297	01F8  51					     push cx
    298	01F9  8B CA					     mov cx, dx
    299	01FB  D1 E2 D1 E2 D1 E2				     shl dx, 3
    300	0201  03 D1					     add dx, cx
    301	0203  03 D1					     add dx, cx
    302	0205  59					     pop cx
    303
    304	0206  03 D0					     add dx, ax
    305
    306	0208  80 3C 20					     cmp byte ptr [si],	' '
    307	020B  75 EA					     jne @@digit
    308
    309	020D					     @return:
    310	020D  C3				     ret
    311	020E				     endp
    312
    313
    314				     end     Start
Turbo Assembler	 Version 4.1	    02/15/26 11:40:00	    Page 7
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/15/26"
??FILENAME			  Text	 "frame	  "
??TIME				  Text	 "11:40:00"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@				  Number [DGROUP:BP-0002]
@@DIGIT				  Near	 DGROUP:01F7
@@RETURN			  Near	 DGROUP:01EB
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 FRAME
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@RETURN				  Near	 DGROUP:020D
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BEG				  Number 0352
DRAW_COLUMN			  Near	 DGROUP:017F
DRAW_STRING			  Near	 DGROUP:014B
GET_NUM_FROM_COMMAND		  Near	 DGROUP:01EE
L				  Near	 DGROUP:01E7
PRINT_COLUMN			  Near	 DGROUP:01B1
PRINT_WORD_IN_FRAME		  Near	 DGROUP:01C0
START				  Near	 DGROUP:0100
STRING				  Near	 DGROUP:0172
SUM_X				  Number 0027
SUM_Y				  Number 0007
SYMBOL_ARR			  Word	 DGROUP:0147

Macro Name

DRAW_COL
DRAW_FRAME
DRAW_FRAME_WORD
DRAW_STR

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  020E Word	  Public  CODE
