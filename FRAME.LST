Turbo Assembler	 Version 4.1	    02/11/26 11:34:06	    Page 1
frame.asm



      1	0000			     .model tiny
      2	0000			     .code
      3
      4				     org 100h
      5
      6				     DRAW_COL macro height, pos_x, pos_y
      7					     mov bx, height
      8					     mov cx, pos_x
      9					     mov di, pos_y
     10					     call draw_column
     11				     ENDM
     12
     13				     MUL_R macro mlp1, mlp2
     14					     push ax
     15					     mov ax, mlp1
     16					     mul mlp2
     17					     mov mlp1, ax
     18					     pop ax
     19				     ENDM
     20				     DRAW_STR macro length, pos_x, pos_y
     21					     mov bx, length
     22					     mov cx, pos_x
     23					     mov di, pos_y
     24					     call draw_string
     25				     ENDM
     26
     27				     DRAW macro	length,	height,	pos_x, pos_y
     28
     29					     DRAW_STR length, pos_x, pos_y
     30					     DRAW_COL height, pos_x, pos_y
     31
     32					     Sum_y equ pos_y + height -	1
     33					     Sum_x equ pos_x + length -	1
     34
     35					     DRAW_STR length, pos_x, Sum_y
     36					     DRAW_COL height, Sum_x, pos_y
     37				     ENDM
     38
     39	0100			     Start:
     40					     ;переход в	сегмент	видеопамяти
     41	0100  B8 B800			     mov ax, 0B800h
     42	0103  8E C0			     mov es, ax
     43
     44					     DRAW 5, 5,	10, 3
1    45
1    46					     DRAW_STR 5, 10, 3
2    47	0105  BB 0005			     mov bx, 5
2    48	0108  B9 000A			     mov cx, 10
2    49	010B  BF 0003			     mov di, 3
2    50	010E  E8 0028			     call draw_string
1    51					     DRAW_COL 5, 10, 3
2    52	0111  BB 0005			     mov bx, 5
2    53	0114  B9 000A			     mov cx, 10
2    54	0117  BF 0003			     mov di, 3
2    55	011A  E8 0044			     call draw_column
1    56
1    57	      =0007			     Sum_y equ 3 + 5 - 1
Turbo Assembler	 Version 4.1	    02/11/26 11:34:06	    Page 2
frame.asm



1    58	      =000E			     Sum_x equ 10 + 5 -	1
1    59
1    60					     DRAW_STR 5, 10, Sum_y
2    61	011D  BB 0005			     mov bx, 5
2    62	0120  B9 000A			     mov cx, 10
2    63	0123  BF 0007			     mov di, Sum_y
2    64	0126  E8 0010			     call draw_string
1    65					     DRAW_COL 5, Sum_x,	3
2    66	0129  BB 0005			     mov bx, 5
2    67	012C  B9 000E			     mov cx, Sum_x
2    68	012F  BF 0003			     mov di, 3
2    69	0132  E8 002C			     call draw_column
     70
     71				     ;	     DRAW_STR 10, 5, 3
     72				     ;	     DRAW_COL 6,  10, 0
     73				     ;
     74				     ;	     DRAW_STR 29, 10, 5
     75				     ;	     DRAW_COL 6,  40, 0
     76
     77	0135  B4 4C			     mov ah, 4ch
     78	0137  CD 21			     int 21h
     79
     80	0139				     draw_string proc
     81
     82						     ;mov word ptr es: [bx+160*4l + 80], (4e03h	or 8000h)
     83						     ;mov bx, 80 ;счетчик
     84
     85						     ;cx pos_x
     86						     ;di pos_y
     87	0139  4B				     dec bx
     88	013A  D1 E1				     shl cx, 1	     ; умножение на 2 (2 байта на символ)
     89	013C  D1 E3				     shl bx, 1	     ; умножение на 2 (2 байта на символ)
     90
     91					     ;=====умножение смещения y	на 160=======
     92	013E  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
     93	      E7 D1 E7
     94	0148  53				     push bx
     95	0149  8B DF				     mov bx, di
     96	014B  D1 E7 D1 E7			     shl di, 2
     97	014F  03 FB				     add di, bx
     98	0151  5B				     pop bx
     99					     ;=================================
    100	0152  03 F9				     add di, cx
    101						     ;add bx, cx
    102						     ; переписать вывод	строки!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    103	0154					     string:
    104	0154  26: C7 01	CE03				     mov word ptr es:[bx + di],	(4e03h or 8000h)
    105	0159  4B					     dec bx
    106	015A  4B					     dec bx
    107	015B  83 FB 00					     cmp bx, 0
    108	015E  7D F4					     jge string
    109
    110	0160  C3				     ret;
    111	0161				     draw_string endp
    112
    113	0161				     draw_column proc
    114						     ;cx pos_x
Turbo Assembler	 Version 4.1	    02/11/26 11:34:06	    Page 3
frame.asm



    115						     ;di pos_y
    116	0161  4B				     dec bx
    117	0162  D1 E1				     shl cx, 1	     ; умножение на 2 (2 байта на символ)
    118	0164  D1 E3				     shl bx, 1	     ; умножение на 2 (2 байта на символ)
    119
    120						     ;=====умножение смещения на 160=======
    121	0166  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
    122	      E7 D1 E7
    123	0170  53				     push bx
    124	0171  8B DF				     mov bx, di
    125	0173  D1 E7 D1 E7			     shl di, 2
    126	0177  03 FB				     add di, bx
    127	0179  5B				     pop bx
    128						     ;=====================================
    129
    130	017A  50				     push ax
    131	017B  51				     push cx
    132	017C  8B C3				     mov ax, bx
    133	017E  B9 0050				     mov cx, 80
    134	0181  F7 E1				     mul cx
    135	0183  8B D8				     mov bx, ax
    136	0185  59				     pop cx
    137	0186  58				     pop ax
    138
    139	0187  03 F9				     add di, cx
    140	0189					     print_column:
    141	0189  26: C7 01	CE03				     mov word ptr es:[bx + di],	(4e03h or 8000h)
    142	018E  81 EB 00A0				     sub bx, 160
    143							     ;dec bx
    144	0192  83 FB 00					     cmp bx, 0
    145	0195  7D F2					     jge print_column
    146
    147	0197  C3				     ret;
    148
    149	0198				     draw_column endp
    150
    151				     end     Start
Turbo Assembler	 Version 4.1	    02/11/26 11:34:06	    Page 4
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/11/26"
??FILENAME			  Text	 "frame	  "
??TIME				  Text	 "11:34:06"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 FRAME
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
DRAW_COLUMN			  Near	 DGROUP:0161
DRAW_STRING			  Near	 DGROUP:0139
PRINT_COLUMN			  Near	 DGROUP:0189
START				  Near	 DGROUP:0100
STRING				  Near	 DGROUP:0154
SUM_X				  Number 000E
SUM_Y				  Number 0007

Macro Name

DRAW
DRAW_COL
DRAW_STR
MUL_R

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0198 Word	  Public  CODE
