Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 1
frame.asm



      1	0000			     .model tiny
      2	0000			     .code
      3
      4				     org 100h
      5
      6				     locals @@
      7				     ;===========================================================================
      8				     ;DESTR: ax, bx, cx, di
      9				     ;===========================================================================
     10
     11				     ; можно передавать	аргументом символа его адрес в памяти
     12
     13				     ; надо написать процедуру,	которая	считывает число	из командной строки
     14
     15	*100			     INF_T struc
     16	*000  01*(001E)			     length dw 30
*Warning* frame.asm(16)	Reserved word used as symbol: LENGTH
     17	*002  01*(0007)			     height dw 7
     18	*004  01*(000A)			     pos_x  dw 10
     19	*006  01*(0003)			     pos_y  dw 3
     20	*008			     INF_T ends
     21
     22	*100			     String_t struc
     23	*000  01*(0000)			     string_ptr	dw 0
     24	*002  01*(0000)			     string_len	dw 0
     25	*004			     String_t ends
     26
     27				     DRAW_COL macro height, pos_x, pos_y, symbol
     28					     mov bx, height
     29					     mov cx, pos_x
     30					     mov di, pos_y
     31
     32					     ; mov ax, symbol
     33					     ; push ax
     34
     35					     call draw_column
     36				     ENDM
     37
     38				     ;===========================================================================
     39				     ;DESTR: ax, bx, cx, di
     40				     ;===========================================================================
     41				     ; 9F96
     42				     DRAW_STR macro length, pos_x, pos_y, symbol
     43					     mov  bx, length
     44					     mov  cx, pos_x
     45					     mov  di, pos_y
     46
     47					     ; mov  ax,	symbol
     48					     ; push ax
     49
     50					     call draw_string
     51				     ENDM
     52
     53				     DRAW_FRAME	macro length, height, pos_x, pos_y, symbol
     54
     55					     call get_num_from_command
     56
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 2
frame.asm



     57					     shl dx, 1 ; arr of	words
     58					     lea bx, Symbol_arr
     59					     add bx, dx
     60
     61					     push cx
     62					     push [bx]
     63
     64					     DRAW_STR length, pos_x, pos_y, symbol
     65					     DRAW_COL height, pos_x, pos_y, symbol
     66
     67					     ; Sum_y = pos_y + height -	1 ; make in func
     68				     ;=====================================================================
     69					     mov di, pos_y
     70					     add di, height
     71					     dec di
     72				     ;=====================================================================
     73					     ; Sum_x = pos_x + length -	1 ; make in func
     74					     ; push di
     75					     DRAW_STR length, pos_x, di, symbol
     76					     ; pop di
     77				     ;=====================================================================
     78					     mov cx, pos_x
     79					     add cx, length
     80					     dec cx
     81				     ;=====================================================================
     82
     83					     DRAW_COL height, cx, pos_y, symbol
     84
     85					     pop bx
     86					     pop cx
     87
     88				     ENDM
     89
     90				     ;очистка экрана
     91				     ;INT 10H 006H
     92
     93	0100			     Start:
     94					     ;
     95	0100  B8 B800			     mov ax, 0B800h
     96	0103  8E C0			     mov es, ax
     97
     98					     ; Подумать	как можно передавать символ для	всех рамок
     99
    100	0105  8A 0E 0080		     mov cl, ds:80h
    101
    102	0109  BE 0082			     mov si, 82h
    103
    104	010C  E8 04D6			     call get_flag_from_command
    105	010F  F6 06 01A7r 40 90		     test FLAGS, 40h
    106	0115  74 07			     je	@@frame
    107	0117  E8 045F				     call print_mona_lisa
    108	011A  B4 4C				     mov ah, 4ch
    109	011C  CD 21				     int 21h
    110
    111	011E				     @@frame:
    112	011E  E8 03AC			     call get_num_from_command
    113	0121  85 D2			     test dx, dx
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 3
frame.asm



    114	0123  74 0B			     je	@@without_size
    115
    116	0125  89 16 0390r		     mov  Inf_frame.length, dx
    117
    118	0129  E8 03A1			     call get_num_from_command
    119	012C  89 16 0392r		     mov  Inf_frame.height, dx
    120
    121	0130				     @@without_size:
    122				     ;
    123					     DRAW_FRAME	Inf_frame.length, Inf_frame.height , Inf_frame.pos_x, Inf_frame.pos_y, 2
1   124
1   125	0130  E8 039A			     call get_num_from_command
1   126
1   127	0133  D1 E2			     shl dx, 1 ; arr of	words
1   128	0135  BB 01A8r			     lea bx, Symbol_arr
1   129	0138  03 DA			     add bx, dx
1   130
1   131	013A  51			     push cx
1   132	013B  FF 37			     push [bx]
1   133
1   134					     DRAW_STR Inf_frame.length,	Inf_frame.pos_x, Inf_frame.pos_y, 2
2   135	013D  8B 1E 0390r		     mov  bx, Inf_frame.length
2   136	0141  8B 0E 0394r		     mov  cx, Inf_frame.pos_x
2   137	0145  8B 3E 0396r		     mov  di, Inf_frame.pos_y
2   138
2   139					     ; mov  ax,	2
2   140					     ; push ax
2   141
2   142	0149  E8 026A			     call draw_string
1   143					     DRAW_COL Inf_frame.height,	Inf_frame.pos_x, Inf_frame.pos_y, 2
2   144	014C  8B 1E 0392r		     mov bx, Inf_frame.height
2   145	0150  8B 0E 0394r		     mov cx, Inf_frame.pos_x
2   146	0154  8B 3E 0396r		     mov di, Inf_frame.pos_y
2   147
2   148					     ; mov ax, 2
2   149					     ; push ax
2   150
2   151	0158  E8 0295			     call draw_column
1   152
1   153					     ; Sum_y = Inf_frame.pos_y + Inf_frame.height - 1 ;	make in	func
1   154				     ;=====================================================================
1   155	015B  8B 3E 0396r		     mov di, Inf_frame.pos_y
1   156	015F  03 3E 0392r		     add di, Inf_frame.height
1   157	0163  4F			     dec di
1   158				     ;=====================================================================
1   159					     ; Sum_x = Inf_frame.pos_x + Inf_frame.length - 1 ;	make in	func
1   160					     ; push di
1   161					     DRAW_STR Inf_frame.length,	Inf_frame.pos_x, di, 2
2   162	0164  8B 1E 0390r		     mov  bx, Inf_frame.length
2   163	0168  8B 0E 0394r		     mov  cx, Inf_frame.pos_x
2   164	016C  8B FF			     mov  di, di
2   165
2   166					     ; mov  ax,	2
2   167					     ; push ax
2   168
2   169	016E  E8 0245			     call draw_string
1   170					     ; pop di
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 4
frame.asm



1   171				     ;=====================================================================
1   172	0171  8B 0E 0394r		     mov cx, Inf_frame.pos_x
1   173	0175  03 0E 0390r		     add cx, Inf_frame.length
1   174	0179  49			     dec cx
1   175				     ;=====================================================================
1   176
1   177					     DRAW_COL Inf_frame.height,	cx, Inf_frame.pos_y, 2
2   178	017A  8B 1E 0392r		     mov bx, Inf_frame.height
2   179	017E  8B C9			     mov cx, cx
2   180	0180  8B 3E 0396r		     mov di, Inf_frame.pos_y
2   181
2   182					     ; mov ax, 2
2   183					     ; push ax
2   184
2   185	0184  E8 0269			     call draw_column
1   186
1   187	0187  5B			     pop bx
1   188	0188  59			     pop cx
1   189
    190				     ;
    191	0189  81 E3 FF00		     and bx, 0ff00h
    192	018D  8B D3			     mov dx, bx
    193
    194	018F  51			     push cx
    195	0190  E8 03B7			     call make_fill
    196	0193  59			     pop cx
    197
    198	0194  32 ED			     xor ch, ch
    199
    200					     ; mov cl, ds:80h
    201	0196  90			     nop
    202	0197  90			     nop
    203	0198  90			     nop
    204	0199  90			     nop
    205
    206	019A  E8 0294			     call read_strings
    207
    208	019D  52			     push dx
    209	019E  E8 02BB			     call print_word_in_frame
    210	01A1  5A			     pop dx
    211
    212
    213
    214	01A2  B8 4C00			     mov ax, 4c00h
    215	01A5  CD 21			     int 21h
    216				     ;===============================================================================================
    217				     ==
    218	01A7  00		     FLAGS db 0
    219	01A8  1F03 4E03	8B55 04C5    Symbol_arr	  dw 1F03h, 4E03h, 8B55h, 04C5h
    220
    221	01B0  08*(0000 0000)	     String_arr	String_t 8 dup(<0, 0>)
    222
    223				     ; Строка 1: "o8%8888," +20	пробелов
    224	01D0  20 20 20 20 20 20	20+  row1 db 20h,20h,20h,20h,20h,20h,20h,20h,6Fh,38h,25h,38h,38h,38h,38h,2Ch,20h,20h,20h,20h,20h,   +
    225	      20 6F 38 25 38 38	38+  20h,20h,20h,20h,20h,20h,20h
    226	      38 2C 20 20 20 20	20+
    227	      20 20 20 20 20 20	20
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 5
frame.asm



    228
    229				     ; Строка 2: "	o88%8888888." +10 пробелов
    230	01EC  20 20 20 20 20 20	6F+  row2 db 20h,20h,20h,20h,20h,20h,6Fh,38h,38h,25h,38h,38h,38h,38h,38h,38h,38h,2Eh,20h,20h,20h,   +
    231	      38 38 25 38 38 38	38+  20h,20h,20h,20h,20h,20h,20h
    232	      38 38 38 2E 20 20	20+
    233	      20 20 20 20 20 20	20
    234
    235				     ; Строка 3: "     8'-    -:8888b" +10 пробелов
    236	0208  20 20 20 20 20 20	38+  row3 db 20h,20h,20h,20h,20h,20h,38h,27h,2Dh,20h,20h,20h,20h,2Dh,3Ah,38h,38h,38h,38h,62h,20h,   +
    237	      27 2D 20 20 20 20	2D+  20h,20h,20h,20h,20h,20h,20h
    238	      3A 38 38 38 38 62	20+
    239	      20 20 20 20 20 20	20
    240
    241				     ; Строка 4: "    8'	 8888" +10 пробелов
    242	0224  20 20 20 20 20 38	27+  row4 db 20h,20h,20h,20h,20h,38h,27h,20h,20h,20h,20h,20h,20h,20h,20h,20h,20h,38h,38h,38h,38h,   +
    243	      20 20 20 20 20 20	20+  20h,20h,20h,20h,20h,20h,20h
    244	      20 20 20 38 38 38	38+
    245	      20 20 20 20 20 20	20
    246
    247				     ; Строка 5: "   d8.-=. ,==-.:888b"	+8 пробелов
    248	0240  20 20 20 64 38 2D	2E+  row5 db 20h,20h,20h,64h,38h,2Dh,2Eh,3Dh,20h,2Ch,3Dh,3Dh,2Dh,2Eh,3Ah,38h,38h,38h,62h,20h,20h,   +
    249	      3D 20 2C 3D 3D 2D	2E+  20h,20h,20h,20h,20h,20h,20h
    250	      3A 38 38 38 62 20	20+
    251	      20 20 20 20 20 20	20
    252
    253				     ; Строка 6: "   >8	`~` :`~' d8888"	+8 пробелов
    254	025C  20 20 20 3E 38 20	60+  row6 db 20h,20h,20h,3Eh,38h,20h,60h,7Eh,60h,20h,3Ah,60h,7Eh,27h,20h,64h,38h,38h,38h,38h, 20h,  +
    255	      7E 60 20 3A 60 7E	27+  20h,20h,20h,20h,20h,20h,20h
    256	      20 64 38 38 38 38	20+
    257	      20 20 20 20 20 20	20
    258
    259				     ; Строка 7: "   88		,88888"	+9 пробелов
    260	0278  20 20 20 20 38 38	20+  row7 db 20h,20h,20h,20h,38h,38h,20h,20h,20h,20h,20h,20h,20h,20h,20h,2Ch,38h,38h,38h,38h,38h,   +
    261	      20 20 20 20 20 20	20+  20h,20h,20h,20h,20h,20h,20h
    262	      20 2C 38 38 38 38	38+
    263	      20 20 20 20 20 20	20
    264
    265				     ; Строка 8: "   88b. `-~  :'88888"	+8 пробелов
    266	0294  20 20 20 20 38 38	62+  row8 db 20h,20h,20h,20h,38h,38h,62h,2Eh,20h,60h,2Dh,7Eh,20h,20h,3Ah,27h,38h,38h,38h,38h,38h,   +
    267	      2E 20 60 2D 7E 20	20+  20h,20h,20h,20h,20h,20h,20h
    268	      3A 27 38 38 38 38	38+
    269	      20 20 20 20 20 20	20
    270
    271				     ; Строка 9: "   888b ~==~ .:88888"	+8 пробелов
    272	02B0  20 20 20 20 38 38	38+  row9 db 20h,20h,20h,20h,38h,38h,38h,62h,20h,7Eh,3Dh,3Dh,7Eh,20h,2Eh,3Ah,38h,38h,38h,38h,38h,   +
    273	      62 20 7E 3D 3D 7E	20+  20h,20h,20h,20h,20h,20h,20h
    274	      2E 3A 38 38 38 38	38+
    275	      20 20 20 20 20 20	20
    276
    277				     ; Строка 10: "   88888o--:':::8888" +8 пробелов
    278	02CC  20 20 20 20 38 38	38+  row10 db 20h,20h,20h,20h,38h,38h,38h,38h,38h,6Fh,2Dh,2Dh,3Ah,27h,27h,27h,3Ah,38h,38h,38h,38h,  +
    279	      38 38 6F 2D 2D 3A	27+  20h,20h,20h,20h,20h,20h,20h
    280	      27 27 3A 38 38 38	38+
    281	      20 20 20 20 20 20	20
    282
    283				     ; Строка 11: "   `88888| :::' 8888b" +7 пробелов
    284	02E8  20 20 20 60 38 38	38+  row11 db 20h,20h,20h,60h,38h,38h,38h,38h,38h,7Ch,20h,3Ah,3Ah,3Ah,27h,20h,38h,38h,38h,38h,62h,  +
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 6
frame.asm



    285	      38 38 7C 20 3A 3A	3A+  20h,20h,20h,20h,20h,20h,20h
    286	      27 20 38 38 38 38	62+
    287	      20 20 20 20 20 20	20
    288
    289				     ; Строка 12: "   8888^^'	    8888b" +6 пробелов
    290	0304  20 20 20 20 38 38	38+  row12 db 20h,20h,20h,20h,38h,38h,38h,38h,5Eh,5Eh,27h,20h,20h,20h,20h,20h,20h,20h,38h,38h,38h,  +
    291	      38 5E 5E 27 20 20	20+  38h,62h, 20h,20h,20h,20h,20h
    292	      20 20 20 20 38 38	38+
    293	      38 62 20 20 20 20	20
    294
    295				     ; Строка 13: "  d888	    ,%888b." +5	пробелов
    296	0320  20 20 64 38 38 38	20+  row13 db 20h,20h,64h,38h,38h,38h,20h,20h,20h,20h,20h,20h,20h,20h,20h,20h,20h,2Ch,25h,38h,38h,  +
    297	      20 20 20 20 20 20	20+  38h,62h,2Eh, 20h,20h,20h,20h
    298	      20 20 20 2C 25 38	38+
    299	      38 62 2E 20 20 20	20
    300
    301				     ; Строка 14: " d88%	    %%%8--'-. "	+4 пробела
    302	033C  20 64 38 38 25 20	20+  row14 db 20h,64h,38h,38h,25h,20h,20h,20h,20h,20h,20h,20h,20h,20h,20h,20h,20h,20h,20h,20h,25h,  +
    303	      20 20 20 20 20 20	20+  25h,25h,38h,2Dh,2Dh,27h,2Dh
    304	      20 20 20 20 20 20	25+
    305	      25 25 38 2D 2D 27	2D
    306
    307				     ; Строка 15: "/88:.__ ,	   _%-'	---  -"	+1 пробел
    308	0358  2F 38 38 3A 2E 5F	5F+  row15 db 2Fh,38h,38h,3Ah,2Eh,5Fh,5Fh,20h,2Ch,20h,20h,20h,20h,20h,20h,20h,5Fh,25h,2Dh,27h,20h,  +
    309	      20 2C 20 20 20 20	20+  2Dh,2Dh,2Dh,20h,2Dh,0Ah,20h
    310	      20 20 5F 25 2D 27	20+
    311	      2D 2D 2D 20 2D 0A	20
    312
    313				     ; Строка 16: "    '''::===..-'   =	 --." +3 пробела
    314	0374  20 20 20 20 27 27	27+  row16 db 20h,20h,20h,20h,27h,27h,27h,3Ah,3Ah,3Dh,3Dh,2Eh,2Dh,27h,20h,20h,20h,20h,3Dh,20h,2Dh,  +
    315	      3A 3A 3D 3D 2E 2D	27+  2Dh,2Eh,20h,20h,20h,20h,20h
    316	      20 20 20 20 3D 20	2D+
    317	      2D 2E 20 20 20 20	20
    318	0390  001E 0007	000A 0003	     Inf_frame INF_T <>
    319
    320	0398  01D0r 01ECr 0208r	  +  MonaLisa dw row1, row2, row3, row4, row5, row6, row7, row8, row9, row10, row11, row12, row13,  +
    321	      0224r 0240r 025Cr	  +  row14, 0000h
    322	      0278r 0294r 02B0r	  +
    323	      02CCr 02E8r 0304r	  +
    324	      0320r 033Cr 0000
    325
    326				     ; Str db 41h, 41h,	41h
    327				     ;===============================================================================================
    328				     ==
    329
    330	03B6				     draw_string proc
    331	03B6  51				     push cx
    332	03B7  57				     push di
    333	03B8  53				     push bx
    334	03B9  55				     push bp
    335	03BA  8B EC				     mov bp, sp
    336	03BC  83 C5 0A				     add bp, 10
    337						     ;mov word ptr es: [bx+160*4l + 80], (4e03h	or 8000h)
    338						     ;mov bx, 80 ;
    339
    340						     ;cx pos_x
    341						     ;di pos_y
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 7
frame.asm



    342	03BF  4B				     dec bx
    343	03C0  D1 E1				     shl cx, 1	     ;
    344	03C2  D1 E3				     shl bx, 1	     ;
    345
    346					     ;===== Умножение смещения на 160 =======
    347	03C4  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
    348	      E7 D1 E7
    349	03CE  53				     push bx
    350	03CF  8B DF				     mov bx, di
    351	03D1  D1 E7 D1 E7			     shl di, 2
    352	03D5  03 FB				     add di, bx
    353	03D7  5B				     pop bx
    354					     ;=======================================
    355	03D8  03 F9				     add di, cx
    356						     ;add bx, cx
    357
    358	03DA  51				     push cx
    359	03DB  33 C9				     xor cx, cx
    360	03DD  8B 4E 00				     mov word ptr cx, [bp]
    361
    362	03E0					     string:
    363	03E0  26: 89 09					     mov word ptr es:[bx + di],	cx
    364	03E3  4B					     dec bx
    365	03E4  4B					     dec bx
    366	03E5  83 FB 00					     cmp bx, 0
    367	03E8  7D F6					     jge string
    368
    369	03EA  59				     pop cx
    370
    371	03EB  5D				     pop bp
    372	03EC  5B				     pop bx
    373	03ED  5F				     pop di
    374	03EE  59				     pop cx
    375	03EF  C3				     ret
    376
    377	03F0				     endp
    378
    379	03F0				     draw_column proc
    380	03F0  55				     push bp
    381	03F1  8B EC				     mov bp, sp
    382	03F3  83 C5 04				     add bp, 4 ; пропускаем адрес возврата
    383
    384						     ;cx pos_x
    385						     ;di pos_y
    386	03F6  4B				     dec bx
    387	03F7  D1 E1				     shl cx, 1	     ; 2 байта на символ
    388	03F9  D1 E3				     shl bx, 1	     ; 2 байта на символ
    389
    390						     ;===== Умножение смещения y на 160=======
    391	03FB  D1 E7 D1 E7 D1 E7	D1+		     shl di, 5
    392	      E7 D1 E7
    393	0405  53				     push bx
    394	0406  8B DF				     mov bx, di
    395	0408  D1 E7 D1 E7			     shl di, 2
    396	040C  03 FB				     add di, bx
    397	040E  5B				     pop bx
    398						     ;========================================
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 8
frame.asm



    399
    400	040F  50				     push ax
    401	0410  51				     push cx
    402	0411  8B C3				     mov ax, bx
    403	0413  B9 0050				     mov cx, 80
    404	0416  F7 E1				     mul cx
    405	0418  8B D8				     mov bx, ax
    406	041A  59				     pop cx
    407	041B  58				     pop ax
    408
    409	041C  03 F9				     add di, cx
    410
    411	041E  51				     push cx
    412	041F  8B 4E 00				     mov word ptr cx, [bp]
    413
    414	0422					     print_column:
    415	0422  26: 89 09					     mov word ptr es:[bx + di],	cx
    416	0425  81 EB 00A0				     sub bx, 160
    417							     ;dec bx
    418	0429  83 FB 00					     cmp bx, 0
    419	042C  7D F4					     jge print_column
    420
    421	042E  59				     pop cx
    422	042F  5D				     pop bp
    423
    424	0430  C3				     ret
    425
    426
    427	0431				     endp
    428
    429				     ;====================================================================
    430				     ;Start:
    431				     ;	 cx - counter of symbols
    432				     ;	     si	- adress of string
    433				     ;
    434				     ;	     bx	- counter of string
    435				     ;
    436				     ;	     cld
    437				     ;Note: "|"	end of string
    438				     ;Return: no
    439				     ;Destr: bx, di, si, ax
    440				     ;====================================================================
    441
    442	0431				     read_strings proc
    443	0431  51			     push cx
    444	0432  33 DB			     xor bx, bx
    445
    446	0434				     @@read:
    447	0434  89 B7 01B0r			     mov String_arr[bx].string_ptr, si
    448
    449	0438  06				     push es
    450	0439  8C D8				     mov ax, ds
    451	043B  8E C0				     mov es, ax
    452	043D  8B FE				     mov di, si
    453	043F  33 C0				     xor ax, ax
    454	0441  B0 25				     mov al, '%'
    455
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 9
frame.asm



    456	0443  8B F1				     mov si, cx	; use for count	symbol in string
    457	0445  F2> AE				     repne scasb ; check last symbol
    458	0447  2B F1				     sub si, cx
    459	0449  4E				     dec si
    460	044A  89 B7 01B2r			     mov String_arr[bx].string_len, si
    461
    462	044E  8B F7				     mov si, di
    463	0450  07				     pop es
    464
    465	0451  83 C3 04				     add bx, size String_t
    466
    467	0454  80 7C FF 0D			     cmp byte ptr [si -	1], 0dh
    468	0458  75 DA				     jne @@read
    469
    470	045A  59			     pop cx
    471	045B  C3			     ret
    472
    473	045C				     endp
    474
    475				     ;====================================================================
    476				     ;Start:
    477				     ;	 ax - address in arrate
    478				     ;	     bx	- counter of strings
    479				     ;	 ||||||cx - counter of symbols
    480				     ;	     si	- adress of string
    481				     ;	 di - adress in	ViMem
    482				     ;
    483				     ;Notes: dx	- count	bytes, center of frame
    484				     ;
    485				     ;Return: ax - число
    486				     ;Destr: cx, si, dx, bx
    487				     ;====================================================================
    488
    489	045C				     print_word_in_frame proc
    490							     ; push cx
    491	045C  55					     push bp
    492	045D  8B EC					     mov bp, sp
    493	045F  83 C5 04					     add bp, 4
    494
    495	0462  33 C0					     xor ax, ax
    496
    497	0464  57					     push di
    498							     ;xor cx, cx
    499	0465  33 FF					     xor di, di
    500							     ;mov cl, ds:80h
    501
    502	0467  80 F9 00					     cmp cl, 0
    503	046A  74 5D					     je	@@return
    504
    505	046C  E8 0099					     call get_middle_frame ; dx	- count	bytes to center
    506
    507				     ;=========================	half of	text =========================
    508	046F  D1 EB D1 EB D1 EB	D1+			     shr bx, 4 ; size of string_t
    509	      EB
    510
    511	0477  D1 EB					     shr bx, 1
    512							     ; shl bx, 1
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 10
frame.asm



    513
    514	0479  83 C3 01					     add bx, 1
    515
    516						     ;===== Умножение bx на 160	=======
    517	047C  D1 E3 D1 E3 D1 E3	D1+			     shl bx, 5
    518	      E3 D1 E3
    519	0486  57					     push di
    520	0487  8B FB					     mov di, bx
    521	0489  D1 E3 D1 E3				     shl bx, 2
    522	048D  03 DF					     add bx, di
    523	048F  5F					     pop di
    524						     ;=================================
    525
    526	0490  F7 DB					     neg bx
    527
    528	0492					     @@text:
    529	0492  FE C9					     dec cl
    530							     ;mov si, 82h
    531							     ;BEG equ 5	* 160 +	40
    532				     ;================================================================
    533
    534				     ;=========================	half of	string =======================
    535							     ; mov di, cx
    536	0494  53					     push bx
    537	0495  8B D8					     mov bx, ax
    538	0497  8B BF 01B2r				     mov di, [String_arr[bx]].string_len
    539	049B  8B B7 01B0r				     mov si, [String_arr[bx]].string_ptr
    540	049F  5B					     pop bx
    541
    542	04A0  D1 EF D1 EF				     shr di, 2
    543	04A4  D1 E7					     shl di, 1
    544	04A6  F7 DF					     neg di
    545	04A8  83 EF 02					     sub di, 2
    546				     ;================================================================
    547
    548	04AB  03 FA					     add di, dx
    549	04AD  03 FB					     add di, bx
    550							     ;mov di, BEG ;  
    551	04AF  50					     push ax
    552	04B0  8A 66 01					     mov ah, [bp + 1];
    553
    554	04B3						     @@string:
    555	04B3  AC						     lodsb
    556	04B4  AB						     stosw
    557								     ; loop @@string
    558	04B5  80 3C 0D						     cmp byte ptr ds:[si], 0dh ; end of	text
    559	04B8  74 0F						     je	@@return
    560
    561	04BA  80 3C 25						     cmp byte ptr ds:[si], '%'
    562	04BD  75 F4						     jne @@string
    563
    564
    565	04BF  58					     pop ax
    566
    567							     ; neg
    568	04C0  81 C3 00A0				     add bx, 160d
    569	04C4  05 0004					     add ax, 4h
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 11
frame.asm



    570	04C7  EB C9					     jmp @@text
    571				     ; можно запустить цикл в котором из середины вычитаться половина длины строки, а после печати  +
    572				     добавлять к середине 160 или 320 и	по новой
    573
    574	04C9						     @@return:
    575	04C9  58					     pop ax ;!!!!!!!!!!!!!!!!!!!!!!
    576	04CA  5F					     pop di
    577							     ; pop cx
    578	04CB  5D					     pop bp
    579	04CC  C3					     ret
    580	04CD					     endp
    581
    582				     ;====================================================================
    583				     ; Start:  cx - number of symbols
    584				     ;		       si - adress of string
    585				     ; Destr:  cx, si, dx, ax
    586				     ; Return: dx - число. dx =	0, если	нет цифры
    587				     ;====================================================================
    588
    589	04CD				     get_num_from_command proc
    590	04CD  33 D2				     xor dx, dx
    591
    592	04CF  80 3C 20				     cmp byte ptr [si],	' '
    593	04D2  74 33				     je	@@return
    594
    595	04D4  80 3C 30				     cmp byte ptr [si],	'0'
    596	04D7  72 2E				     jb	@@return
    597
    598	04D9  80 3C 39				     cmp byte ptr [si],	'9'
    599	04DC  7F 29				     jg	@@return
    600
    601	04DE  33 C0				     xor ax, ax
    602
    603	04E0					     @@digit:
    604	04E0  AC					     lodsb
    605
    606	04E1  51					     push cx
    607	04E2  8B CA					     mov cx, dx
    608	04E4  D1 E2 D1 E2 D1 E2				     shl dx, 3
    609	04EA  03 D1					     add dx, cx
    610	04EC  03 D1					     add dx, cx
    611	04EE  59					     pop cx
    612
    613							     ;sub ax, '0'
    614	04EF  24 0F					     and al, 0fh
    615	04F1  03 D0					     add dx, ax
    616	04F3  49					     dec cx
    617
    618	04F4  80 3C 30					     cmp byte ptr [si],	'0'
    619	04F7  76 0A					     jbe @@end_cicle
    620
    621	04F9  80 3C 39					     cmp byte ptr [si],	'9'
    622	04FC  7D 05					     jge @@end_cicle
    623
    624	04FE  80 3C 20					     cmp byte ptr [si],	' '
    625	0501  75 DD					     jne @@digit
    626
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 12
frame.asm



    627	0503					     @@end_cicle:
    628
    629	0503  49				     dec cx
    630	0504  83 C6 01				     add si, 1 ; skip_space
    631
    632	0507					     @@return:
    633	0507  C3				     ret
    634	0508				     endp
    635
    636				     ;====================================================================
    637				     ; Start: Inf_struc
    638				     ; Destr: dx
    639				     ; Return: dx - число
    640				     ;====================================================================
    641
    642	0508				     get_middle_frame proc
    643	0508  55				     push bp
    644	0509  8B EC				     mov bp, sp
    645
    646						     ; xor dx, dx
    647
    648	050B  8B 16 0394r			     mov dx, Inf_frame.pos_x
    649	050F  D1 E2				     shl dx, 1
    650	0511  03 16 0390r			     add dx, Inf_frame.length
    651	0515  4A				     dec dx
    652	0516  D1 E2				     shl dx, 1
    653
    654	0518  50				     push ax
    655	0519  A1 0396r				     mov ax, Inf_frame.pos_y
    656	051C  D1 E0				     shl ax, 1
    657	051E  03 06 0392r			     add ax, Inf_frame.height
    658	0522  48				     dec ax
    659	0523  48				     dec ax
    660	0524  05 0001				     add ax, 1
    661	0527  D1 E8				     shr ax, 1
    662	0529  D1 E0				     shl ax, 1
    663
    664						     ;===== Умножение ax на 80=============
    665	052B  D1 E0 D1 E0 D1 E0	D1+		     shl ax, 5
    666	      E0 D1 E0
    667	0535  53				     push bx
    668	0536  8B D8				     mov bx, ax
    669	0538  D1 E0 D1 E0			     shl ax, 2
    670	053C  03 C3				     add ax, bx
    671	053E  5B				     pop bx
    672						     ;=====================================
    673
    674	053F  03 D0				     add dx, ax
    675
    676	0541  58				     pop ax
    677
    678	0542  D1 EA D1 EA			     shr dx, 2
    679	0546  D1 E2				     shl dx, 1
    680
    681	0548  5D				     pop bp
    682	0549  C3				     ret
    683	054A				     endp
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 13
frame.asm



    684				     ;====================================================================
    685				     ; Start: data in struc, bx	- symb
    686				     ; Destr: cx, ax
    687				     ;====================================================================
    688
    689	054A				     make_fill proc
    690	054A  55				     push bp
    691	054B  8B EC				     mov bp, sp
    692
    693	054D  A1 0392r				     mov ax, Inf_frame.height
    694	0550  2D 0002				     sub ax, 2
    695
    696	0553  53				     push bx
    697
    698	0554  8B 1E 0390r			     mov bx, Inf_frame.length
    699	0558  83 EB 02				     sub bx, 2
    700
    701	055B  8B 0E 0394r			     mov cx, Inf_frame.pos_x
    702	055F  41				     inc cx
    703
    704	0560  8B 3E 0396r			     mov di, Inf_frame.pos_y
    705	0564  47				     inc di
    706
    707	0565					     @@print_string:
    708
    709	0565  E8 FE4E					     call draw_string
    710	0568  47					     inc di
    711
    712	0569  48					     dec ax
    713	056A  3D 0000					     cmp ax, 0
    714	056D  75 F6					     jne @@print_string
    715
    716	056F  5B				     pop bx
    717	0570  5D				     pop bp
    718
    719	0571  C3				     ret
    720	0572				     endp
    721				     ;=======================================================================
    722				     ; Start: cx - количество символов в массиве, si - адресс начала массива,
    723				     ; di - адресс в видеопамяти
    724				     ; Destr: ax, cx, si, di
    725				     ;
    726				     ;=======================================================================
    727
    728	0572				     print_arr proc
    729	0572  B4 0F				     mov ah, 0fh
    730	0574					     @@print:
    731	0574  AC					     lodsb
    732	0575  AB					     stosw
    733	0576  E2 FC					     loop @@print
    734
    735	0578  C3				     ret
    736	0579				     endp
    737
    738	0579				     print_mona_lisa proc
    739						     DRAW_FRAME	30, 16,	10, 0, 1
1   740
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 14
frame.asm



1   741	0579  E8 FF51			     call get_num_from_command
1   742
1   743	057C  D1 E2			     shl dx, 1 ; arr of	words
1   744	057E  BB 01A8r			     lea bx, Symbol_arr
1   745	0581  03 DA			     add bx, dx
1   746
1   747	0583  51			     push cx
1   748	0584  FF 37			     push [bx]
1   749
1   750					     DRAW_STR 30, 10, 0, 1
2   751	0586  BB 001E			     mov  bx, 30
2   752	0589  B9 000A			     mov  cx, 10
2   753	058C  BF 0000			     mov  di, 0
2   754
2   755					     ; mov  ax,	1
2   756					     ; push ax
2   757
2   758	058F  E8 FE24			     call draw_string
1   759					     DRAW_COL 16, 10, 0, 1
2   760	0592  BB 0010			     mov bx, 16
2   761	0595  B9 000A			     mov cx, 10
2   762	0598  BF 0000			     mov di, 0
2   763
2   764					     ; mov ax, 1
2   765					     ; push ax
2   766
2   767	059B  E8 FE52			     call draw_column
1   768
1   769					     ; Sum_y = 0 + 16 -	1 ; make in func
1   770				     ;=====================================================================
1   771	059E  BF 0000			     mov di, 0
1   772	05A1  83 C7 10			     add di, 16
1   773	05A4  4F			     dec di
1   774				     ;=====================================================================
1   775					     ; Sum_x = 10 + 30 - 1 ; make in func
1   776					     ; push di
1   777					     DRAW_STR 30, 10, di, 1
2   778	05A5  BB 001E			     mov  bx, 30
2   779	05A8  B9 000A			     mov  cx, 10
2   780	05AB  8B FF			     mov  di, di
2   781
2   782					     ; mov  ax,	1
2   783					     ; push ax
2   784
2   785	05AD  E8 FE06			     call draw_string
1   786					     ; pop di
1   787				     ;=====================================================================
1   788	05B0  B9 000A			     mov cx, 10
1   789	05B3  83 C1 1E			     add cx, 30
1   790	05B6  49			     dec cx
1   791				     ;=====================================================================
1   792
1   793					     DRAW_COL 16, cx, 0, 1
2   794	05B7  BB 0010			     mov bx, 16
2   795	05BA  8B C9			     mov cx, cx
2   796	05BC  BF 0000			     mov di, 0
2   797
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 15
frame.asm



2   798					     ; mov ax, 1
2   799					     ; push ax
2   800
2   801	05BF  E8 FE2E			     call draw_column
1   802
1   803	05C2  5B			     pop bx
1   804	05C3  59			     pop cx
1   805
    806
    807	05C4  BF 0016				     mov di, 22	; (10 +	1) * 2 ; можно подшаманить с отступом
    808	05C7  81 C7 00A0			     add di, 160 ; 4 * 160
    809	05CB  BB 0398r				     lea bx, MonaLisa
    810
    811	05CE					     @@mona:
    812	05CE  8B 37					     mov si, [bx]
    813	05D0  B9 001C					     mov cx, 28
    814
    815	05D3  57					     push di
    816	05D4  E8 FF9B					     call print_arr
    817	05D7  5F					     pop di
    818
    819	05D8  81 C7 00A0				     add di, 160
    820	05DC  83 C3 02					     add bx, 2
    821
    822	05DF  83 3F 00					     cmp word ptr [bx],	0000h
    823	05E2  75 EA					     jne @@mona
    824
    825	05E4  C3				     ret
    826	05E5				     endp
    827
    828				     ;=======================================================================
    829				     ; Start: si - адресс начала флага
    830				     ; Destr: si
    831				     ; Notes: сдвигается указатель на строку в si
    832				     ;=======================================================================
    833
    834	05E5				     get_flag_from_command proc
    835	05E5  80 3C 2D				     cmp byte ptr [si],	'-'
    836	05E8  75 0C				     jne @@exit
    837	05EA  46				     inc si
    838
    839	05EB  80 3C 6D				     cmp byte ptr [si],	'm'
    840
    841	05EE  75 06				     jne @@exit
    842	05F0  46				     inc si
    843	05F1  80 0E 01A7r 40			     or	FLAGS, 40h
    844						     ; jmp @@exit
    845
    846	05F6					     @@exit:
    847	05F6  C3				     ret
    848	05F7				     endp
    849
    850				     end     Start
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 16
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/21/26"
??FILENAME			  Text	 "frame	  "
??TIME				  Text	 "11:02:40"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@DIGIT				  Near	 DGROUP:04E0
@@END_CICLE			  Near	 DGROUP:0503
@@EXIT				  Near	 DGROUP:05F6
@@FRAME				  Near	 DGROUP:011E
@@MONA				  Near	 DGROUP:05CE
@@PRINT				  Near	 DGROUP:0574
@@PRINT_STRING			  Near	 DGROUP:0565
@@READ				  Near	 DGROUP:0434
@@RETURN			  Near	 DGROUP:04C9
@@RETURN			  Near	 DGROUP:0507
@@STRING			  Near	 DGROUP:04B3
@@TEXT				  Near	 DGROUP:0492
@@WITHOUT_SIZE			  Near	 DGROUP:0130
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 FRAME
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
DRAW_COLUMN			  Near	 DGROUP:03F0
DRAW_STRING			  Near	 DGROUP:03B6
FLAGS				  Byte	 DGROUP:01A7
GET_FLAG_FROM_COMMAND		  Near	 DGROUP:05E5
GET_MIDDLE_FRAME		  Near	 DGROUP:0508
GET_NUM_FROM_COMMAND		  Near	 DGROUP:04CD
INF_FRAME			  Struct DGROUP:0390 INF_T
MAKE_FILL			  Near	 DGROUP:054A
MONALISA			  Word	 DGROUP:0398
PRINT_ARR			  Near	 DGROUP:0572
PRINT_COLUMN			  Near	 DGROUP:0422
PRINT_MONA_LISA			  Near	 DGROUP:0579
PRINT_WORD_IN_FRAME		  Near	 DGROUP:045C
READ_STRINGS			  Near	 DGROUP:0431
ROW1				  Byte	 DGROUP:01D0
ROW10				  Byte	 DGROUP:02CC
ROW11				  Byte	 DGROUP:02E8
ROW12				  Byte	 DGROUP:0304
ROW13				  Byte	 DGROUP:0320
ROW14				  Byte	 DGROUP:033C
ROW15				  Byte	 DGROUP:0358
ROW16				  Byte	 DGROUP:0374
ROW2				  Byte	 DGROUP:01EC
ROW3				  Byte	 DGROUP:0208
ROW4				  Byte	 DGROUP:0224
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 17
Symbol Table



ROW5				  Byte	 DGROUP:0240
ROW6				  Byte	 DGROUP:025C
ROW7				  Byte	 DGROUP:0278
ROW8				  Byte	 DGROUP:0294
ROW9				  Byte	 DGROUP:02B0
START				  Near	 DGROUP:0100
STRING				  Near	 DGROUP:03E0
STRING_ARR			  Struct DGROUP:01B0 STRING_T
SYMBOL_ARR			  Word	 DGROUP:01A8

Macro Name

DRAW_COL
DRAW_FRAME
DRAW_STR

Structure Name			  Type	Offset

INF_T
 LENGTH				  Word	 0000
 HEIGHT				  Word	 0002
 POS_X				  Word	 0004
 POS_Y				  Word	 0006
STRING_T
 STRING_PTR			  Word	 0000
 STRING_LEN			  Word	 0002

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  05F7 Word	  Public  CODE
Turbo Assembler	 Version 4.1	    02/21/26 11:02:41	    Page 18
Error Summary



*Warning* frame.asm(16)	Reserved word used as symbol: LENGTH
